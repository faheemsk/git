<%-- 
    Document   : viewvulnerabilitydetails
    Created on : May 27, 2016, 5:07:16 PM
    Author     : sathuluri
--%>
<%@taglib prefix="c" uri="/WEB-INF/tlds/c.tld" %>
<%@taglib uri="/WEB-INF/tlds/fn.tld" prefix="fn"%>
<%@taglib uri="http://jakarta.apache.org/taglibs/unstandard-1.0" prefix="un"%>
<un:useConstants className="com.optum.oss.constants.ApplicationConstants" var="constants" />
<div id="showviewvul">
    <div class="ux-float-left">
        <h2>View Finding</h2>
    </div>	
    <div class="ux-float-right ux-margin-bottom-1t">
    </div>
    <div class="ux-clear"></div>
    <script>
        $(document).ready(function() {
            $("#vulaccordion").accordion({
               collapsible: true
           });
        });
    </script>
    <div id="vulaccordion" class="ux-margin-top-2t" >
        <!--<div class="ux-accordion-panl-header ux-panl-with-underline" >
            <h2><a class="menuitem submenuheader " href="#" > Vulnerability Details</a></h2>
        </div>-->
        <h3>Finding Details</h3>
        <div class="ux-accordion-panl">
            <div class="ux-hform">
                <dl>
                    <dt>
                    <label>Service:</label>
                    </dt>
                    <dd>${vulnerabilityDTO.clientEngagementDTO.securityServiceName}</dd>
                </dl>
                <dl>
                    <dt>
                    <label>Source:</label>
                    </dt>
                    <dd>${vulnerabilityDTO.sourceName}</dd>
                </dl>
                
                <div class="ux-clear"></div>
                <dl>
                    <dt>
                    <label>Finding Instance: 123</label>
                    </dt>
                    <dd>${vulnerabilityDTO.instanceIdentifier}</dd>
                </dl>

                <dl>
                    <dt>
                    <label>IP Address:</label>
                    </dt>
                    <dd>${vulnerabilityDTO.ipAddress}</dd>
                </dl>

                <dl>
                    <dt>
                    <label>Host:</label>
                    </dt>
                    <dd style="word-wrap: break-word;"><c:out value="${vulnerabilityDTO.hostName}"></c:out></dd>
                </dl>
                <dl>
                    <dt>
                    <label>Domain:</label>
                    </dt>
                    <dd style="word-wrap: break-word;"><c:out value="${vulnerabilityDTO.domainName}"></c:out></dd>
                </dl>

                <dl>
                    <dt>
                    <label>Port:</label>
                    </dt>
                    <dd><c:out value="${vulnerabilityDTO.portNumber}"></c:out> </dd>
                </dl>
                
                <div class="ux-clear"></div>
                <dl>
                    <dt>
                    <label>MAC Address:</label>
                    </dt>
                    <dd style="word-wrap: break-word;"><c:out value="${vulnerabilityDTO.macAddress}"></c:out></dd>
                </dl>
                
                <dl>
                    <dt>
                    <label>Netbios:</label>
                    </dt>
                    <dd><c:out value="${vulnerabilityDTO.netbiosName}"></c:out></dd>
                </dl>
                
                <dl>
                    <dt>
                    <label>Operating System:
                    </label>
                    </dt>
                    <dd><c:out value="${vulnerabilityDTO.operatingSystem}"></c:out></dd>
                </dl>
                <dl>
                    <dt>
                    <label >Application Name:</label>
                    </dt>
                    <dd style="word-wrap: break-word;"><c:out value="${vulnerabilityDTO.softwareName}"escapeXml="true"></c:out></dd>
                </dl>
                <dl>
                    <dt>
                    <label>URL:</label>
                    </dt>
                    <dd style="word-wrap: break-word;"><c:out value="${vulnerabilityDTO.appURL}"></c:out></dd>
                </dl>
                    <c:if test="${vulnerabilityDTO.sourceName != 'Manual'}"> 
                <div class="ux-clear"></div>
                <dl>
                    <dt>
                    <label>Scan Tool</label>
                    </dt>
                    <dd><c:out value="${vulnerabilityDTO.scanTool}"escapeXml="true"></c:out></dd>
                </dl>
                <dl>
                    <dt>
                    <label>Scan Start Date:</label>
                    </dt>
                    <dd><c:out value="${vulnerabilityDTO.scanStartDate}"escapeXml="true"></c:out></dd>
                </dl>
                <dl>
                    <dt>
                    <label>Scan End Date:</label>
                    </dt>
                    <dd><c:out value="${vulnerabilityDTO.scanEndDate}"escapeXml="true"></c:out></dd>
                </dl>
                <dl>
                    <dt>
                    <label>Scan Identifier:</label>
                    </dt>
                    <dd>${vulnerabilityDTO.scanIdentifier}</dd>
                </dl>
                
                <div class="ux-clear"></div>
                <dl>
                    <dt>
                    <label>Scan Severity Level</label>
                    </dt>
                    <dd>${vulnerabilityDTO.srcSeverityLevel}</dd>
                </dl>
                <dl>
                    <dt>
                    <label>Scan Base Score</label>
                    </dt>
                    <dd>${vulnerabilityDTO.cveInformationDTO.srcBaseScore}</dd>
                </dl>
                <dl>
                    <dt>
                    <label>Scan Temporal Score</label>
                    </dt>
                    <dd>${vulnerabilityDTO.cveInformationDTO.srctemporalScore}</dd>
                </dl>
                <dl>
                    <dt>
                    <label>Scan Vector</label>
                    </dt>
                    <dd>${vulnerabilityDTO.vectorText}</dd>
                </dl>
                    </c:if>
            </div>
        </div>
        </div>
        <div class="ux-panl ux-float-left ux-margin-top-1t">
            <div class="ux-panl-header ux-panl-with-underline">
                <h2>Finding Information</h2>
            </div>
            <div class="ux-panl-content">
                <div class="ux-hform">
                    <dl class="ux-width-35t">
                        <dt>
                        <label>Finding Name:</label>
                        </dt>
                        <dd>${vulnerabilityDTO.vulnerabilityName}</dd>
                    </dl>
                    <dl class="ux-width-35t">
                        <dt>
                        <label>Finding Create Date:</label>
                        </dt>
                        <dd><c:out value="${vulnerabilityDTO.createdDate}"></c:out></dd>
                    </dl>
                    <div class="ux-clear"></div>
                    <dl class="ux-width-35t">
                        <dt>
                        <label>Finding Description:</label>
                        </dt>
                        <dd>${vulnerabilityDTO.description}</dd>
                    </dl>
                    <dl class="ux-width-35t">
                        <dt>
                        <label>Technical Details:</label>
                        </dt>
                        <dd>${vulnerabilityDTO.techDetails}</dd>
                    </dl>
                    <div class="ux-clear"></div>
                    <dl class="ux-width-35t">
                        <dt>
                        <label>Impact Detail:</label>
                        </dt>
                        <dd>${vulnerabilityDTO.impactDetails}</dd>
                    </dl>
                    <dl class="ux-width-35t">
                        <dt>
                        <label>Recommendation:</label>
                        </dt>
                        <dd>${vulnerabilityDTO.recommendation}</dd>
                    </dl>
                    <div class="ux-clear"></div>
                    <dl class="ux-width-35t">
                        <dt>
                        <label>Vulnerability Category:</label>
                        </dt>
                        <dd><c:out value="${vulnerabilityDTO.rootCauseName}"></c:out></dd>
                    </dl>
                    <c:if test="${vulnerabilityDTO.securityServiceObj.securityServiceCode eq 'AV'}">
                        <dl class="ux-width-35t"  id="showOWASPId">
                            <dt>
                            <label>OWASP Top 10: </label>
                            </dt>
                            <dd><c:out value="${vulnerabilityDTO.owaspName}"></c:out></dd>
                        </dl>
                    </c:if>
                    <!--<div class="ux-clear"></div>-->
                </div>
            </div>
        </div>
                    
        <!-- Start: Finding Status -->
        <div class="ux-panl ux-float-left">
        <div class="ux-panl-header ux-panl-with-underline">
          <h2>Finding Status</h2>
        </div>
        <div class="ux-panl-content">
            <div class="ux-hform">
             	<dl>
                    <dt><label>Status:</label></dt>
                    <dd><c:out value="${vulnerabilityDTO.statusName}"></c:out></dd>
                </dl>
                   
                <dl >
                    <dt><label>Closure Date:</label></dt>
                    <dd>${vulnerabilityDTO.closedDate}</dd>
                </dl>
                <dl>
                    <dt><label>Validation Date:</label></dt>
                    <dd>${vulnerabilityDTO.validatedDate}</dd>
                </dl>
                <div class="ux-clear"></div>

                <dl class="LongTxt">
                    <dt><label>Reason for Closure:</label></dt>
                    <dd>${vulnerabilityDTO.closedComments}</dd>
                    <label id="errorclosedCommentsId" class="ux-msg-error-under"></label>
                </dl>
            </div>
            <div class="ux-clear"></div>
          		
        </div>
      </div>
        <!-- End: Finding Status -->
        
        <a name="addcve" id="addcve"></a>
        <div class="ux-panl ux-float-left">
            <div class="ux-panl-header ux-panl-with-underline">
                <h2>CVE Information</h2>
            </div>
            <div class="ux-panl-content">
                <div class="ux-hform">
                    <dl >
                        <dt><label>CVE ID:</label></dt>
                        <dd>${vulnerabilityDTO.cveInformationDTO.cveIdentifier}</dd>
                    </dl>    
                    <div class="ux-clear"></div>
                    <span class="">
                        <h3 class="ux-margin-bottom-1t">CVE Details</h3>
                        <dl>
                            <dt><label>CWE ID:</label></dt>
                            <dd>${vulnerabilityDTO.cveInformationDTO.cweID}</dd>
                        </dl> 
                        <dl>
                            <dt><label>Updated Date:</label></dt>
                            <dd><c:out value="${vulnerabilityDTO.cveInformationDTO.updatedDate}"></c:out></dd>
                        </dl>
                        <dl class="LongTxt">
                            <dt><label>CVE Summary:</label></dt>
                            <dd>${vulnerabilityDTO.cveInformationDTO.cveDesc}</dd>
                        </dl>
                    </span>  
                </div>
            </div>
        </div>
        <a name="map" id="map"></a>
        <div class="ux-panl ux-float-left ux-margin-right-1t scorepanelbox
             <c:if test="${vulnerabilityDTO.sourceName ne 'Manual' && pageName ne 'ADDPAGE'}">
                scorepanelbox1
            </c:if>
             " >
            <div class="ux-panl-header ux-panl-with-underline">
                <h2 style="display:inline; position:relative; top:10px;">CVSS Scoring </h2>
            </div>
            <!--       <button>&raquo;</button>
            -->
            <div class="ux-FormStyleLeftAlign scorepanelform" >
              
                <c:if test="${vulnerabilityDTO.sourceName ne 'Manual' && pageName ne 'ADDPAGE'}">
                <dl class="ux-width-30t">
                    <dt>
                    <label>Source Vulnerability Base Score:</label>
                    </dt>
                    <dd><c:out value="${vulnerabilityDTO.cveInformationDTO.srcBaseScore}"></c:out></dd>
                </dl>
                </c:if>
                
                <dl class="ux-width-30t">
                    <dt >
                    <label>Base Score:</label>
                    </dt>
                    <dd><c:out value="${vulnerabilityDTO.cveInformationDTO.baseScore}"></c:out></dd>
                </dl>
                <dl  class="ux-width-30t">
                    <dt>
                    <label>Temporal Score:</label>
                    </dt>
                    <dd><c:out value="${vulnerabilityDTO.cveInformationDTO.temporalScore}"></c:out></dd>


                </dl>
                <dl class="ux-width-30t" >
                    <dt >
                    <label>Environmental Score:</label>
                    </dt>
                    <dd><c:out value="${vulnerabilityDTO.cveInformationDTO.environmentalScore}"></c:out></dd>
            </dl>
                <dl class="ux-width-30t" >
                    <dt >
                    <label>Overall Score:</label>
                    </dt>
                    <dd><c:out value="${vulnerabilityDTO.cveInformationDTO.overallScore}"></c:out></dd>
                </dl>
            </div>
              
                
                
         </div>       
        <div class="ux-panl ux-float-left  scorepanelbox
             <c:if test="${vulnerabilityDTO.sourceName ne 'Manual' && pageName ne 'ADDPAGE'}">
                scorepanelbox1
            </c:if>
             " >
            <div class="ux-panl-header ux-panl-with-underline">
                <h2>Risk</h2>
            </div>
            <div class="ux-FormStyleLeftAlign scorepanelform">
                <dl class="ux-width-30t">
                    <dt>
                    <label>Severity:</label>
                    </dt>
                    <dd><c:out value="${vulnerabilityDTO.cveInformationDTO.severityName}"></c:out> </dd>
                </dl>
                <dl class="ux-width-30t">
                    <dt>
                    <label>Probability:</label>
                    </dt>
                    <dd><c:out value="${vulnerabilityDTO.cveInformationDTO.probabilityName}"></c:out> </dd>
                </dl>
                <dl class="ux-width-30t">
                    <dt>
                    <label>Impact:</label>
                    </dt>
                    <dd><c:out value="${vulnerabilityDTO.cveInformationDTO.impactName}"></c:out></dd>
                </dl>
                <dl class="ux-width-30t">
                    <dt>
                    <label>Cost Effort:</label>
                    </dt>
                    <dd><c:out value="${vulnerabilityDTO.cveInformationDTO.costEffortName}"></c:out> </dd>
                </dl>
            </div>
        </div>
        <div class="ux-clear"></div>

        <div class="ux-panl ux-float-left">
            <div class="ux-panl-header ux-panl-with-underline">
                <h2>Compliance Information <a name="compliance" id="compliance"></a></h2>
            </div>
            <div class="ux-panl-content">
                <!--<span class="ux-float-left ux-margin-bottom-1t"> <strong>HITRUST Lookup:</strong> <input type="text" id="hitrustLookupID" value="" /><a href="#" onclick="javascript:findHitrustLookup();" class="ux-icon-add" title="Add Control" ></a><a href="#" onclick="javascript:popup(1);" class="ux-icon-lookup" title="Add Control" ></a> </span>-->
                <div class="ux-clear"></div>
                <script>
                    $(document).ready(function() {
                        $("#ciaccordion").accordion({
                            collapsible: true,
                            heightStyle: "content"
                        });
                    });
                </script>
                <div id="ciaccordion" class="ux-margin-top-2t">
                <c:choose>
                    <c:when test="${comMap.size()> 0}">
                        <c:set var="loopCnt" value="0" />
                        <c:forEach var="comMap" items="${comMap}">
                            <c:set var="loopCnt" value="${loopCnt+1}" />
                            <h3>
                                ${comMap.key}
                            </h3>
                            <div class="ux-accordion-panl">
                                <div class="ux-margin-1t">
                                    <!--<div class="submenu ux-padding-halft" >-->
                                    <c:set var="FamilyMapValue" value="${comMap.value}" />
                                    <table class="ux-tabl-data valignTop" id="complianceTable">
                                        <thead>
                                            <tr>
                                                <th class="ux-padding-1t" width="5%"></th>
                                                <th class="ux-padding-1t" width="25%">Control</th>
                                                <th class="ux-padding-1t" width="25%">Control description</th>
                                                <th class="ux-padding-1t" width="25%">Objective</th>
                                                <th class="ux-padding-1t" width="20%">Family</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <c:forEach var="FamilyMapVar" items="${FamilyMapValue}">
                                                <tr>
                                                    <td><input type="checkbox" name="dftChkHitrust" value="${FamilyMapVar.controlCode}" disabled="true" <c:if test="${FamilyMapVar.checkedHitrust eq constants.DB_ROW_STATUS_ACTIVE_VALUE}"> checked="true"</c:if> /></td>
                                                    <td>${FamilyMapVar.controlCode}&nbsp;${FamilyMapVar.controlName}</td>
                                                    <td>${FamilyMapVar.controlDesc}</td>
                                                    <td>${FamilyMapVar.objectiveCode}&nbsp;${FamilyMapVar.objectiveName}</td>
                                                    <td>${FamilyMapVar.familyCode}&nbsp;${FamilyMapVar.familyName}</td>

                                                </tr>
                                            </c:forEach>
                                        </c:forEach>
                                    </tbody></table>
                            </div>
                        </div>
                    </c:when>
                    <c:otherwise>
                        No matching records found
                    </c:otherwise>
                </c:choose>
                <c:choose>
                    <c:when test="${crossWalkMap.size()> 0}">
                        <c:forEach var="crossWalkMap" items="${crossWalkMap}">
                            <h3>${crossWalkMap.key}</h3>
                            <c:set var="crossWalkMapValue" value="${crossWalkMap.value}" />
                            <div class="ux-accordion-panl">
                                <div class="ux-margin-1t">
                                        <table class="ux-tabl-data valignTop" id="complianceTable">
                                            <thead>
                                                <tr>
                                                    <th class="ux-padding-1t" width="25%">Control</th>
                                                    <th class="ux-padding-1t" width="25%">Control description</th>
                                                    <th class="ux-padding-1t" width="25%">Objective</th>
                                                    <th class="ux-padding-1t" width="20%">Family</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <c:choose>
                                                    <c:when test="${crossWalkMapValue.size()> 0}">
                                                        <c:forEach var="crossWalkMapVar" items="${crossWalkMapValue}">
                                                            <tr>
                                                                <td>${crossWalkMapVar.controlCode}&nbsp;${crossWalkMapVar.controlName}</td>
                                                                <td>${crossWalkMapVar.controlDesc}</td>
                                                                <td>${crossWalkMapVar.objectiveCode}&nbsp;${crossWalkMapVar.objectiveName}</td>
                                                                <td>${crossWalkMapVar.familyCode}&nbsp;${crossWalkMapVar.familyName}</td>
                                                            </tr>
                                                        </c:forEach>
                                                    </c:when>
                                                </c:choose>

                                            </tbody></table>
                                    </div>
                            </div>
                        </c:forEach>
                    </c:when>
                    <c:otherwise></c:otherwise>
                </c:choose>
            </div>
        </div>
    </div>
    <div class="ux-clear"></div>
    <a name="success" id="success"></a>
    <div class="ux-msg-success msg" style="display:none;">Vulnerability Information has been updated successfully</div>
    <div class="ux-float-right" style="margin-bottom:20px;">
        <input name="" type="button" value="Back" title="Back" class="ux-btn ux-btn-default-action" onclick="headerFn('analystvalidationworklist.htm')"/>
    </div>
</div>
