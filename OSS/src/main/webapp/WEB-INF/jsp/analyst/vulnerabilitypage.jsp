<%-- 
    Document   : vulnerabilitypage
    Created on : May 26, 2016, 5:41:36 PM
    Author     : sbhagavatula
--%>

<%@page contentType="text/html" pageEncoding="UTF-8"%>
<%@taglib prefix="c" uri="/WEB-INF/tlds/c.tld" %>
<%@taglib prefix="spring" uri="/WEB-INF/tlds/spring-form.tld"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=9; IE=10; IE=EDGE" />
        <meta name="viewport" content="width=device-width" />
        <title>IRMaaS</title>
        <!-- CSS : Include -->
        <jsp:include page="../includes/commoncss.jsp"/>
        <link rel="stylesheet" href="<c:url value="/appcss/vulnerabilitypage.css"/>" />
        <link rel="stylesheet" href="<c:url value="/css/tablednd.css"/>" type="text/css"/>
        <!-- CSS : Include -->

        <!-- JS : Include -->
        <script src="appjs/nicEditForFinding.js" type="text/javascript"></script>
        <jsp:include page="../includes/commonjs.jsp"/>
        <script type="text/javascript" src="<c:url value="/js/ddaccordion.js"/>"></script>
        <script type="text/javascript" src="<c:url value="/appjs/reviewvulnerabilityJS.js"/>"></script>
        <script type="text/javascript" src="<c:url value="/js/jquery.tablednd.0.7.min.js"/>"></script>
        <!-- JS : Include -->

    </head>
    <body>
        <div class="loader"></div>
        <!-- Start: Wrapper -->
        <div id="ux-wrapper"> 

            <!-- Header : Include -->
            <jsp:include page="../includes/header.jsp"/>
            <!-- Header : Include -->

            <!-- Start: Breadcrumbs -->
            <ul class="ux-brdc ux-margin-left-1t" >
                <li>Optum Security Solutions</li>
                <li><a href="#" onclick="headerFn('analystvalidationworklist.htm')" title="Analyst Validation Module">Analyst Validation Module</a></li>
                <li><a href="javascript:void(0)" id="reviewVulnerabilityBreadcrumb" title="Review Finding List">Review Finding List</a></li>
                <c:choose>
                    <c:when test="${pageName eq 'ADDPAGE'}">
                        <li>Add New Finding</li>
                    </c:when>
                    <c:otherwise>
                        <li>Update Finding</li>
                    </c:otherwise>
                </c:choose>
                
            </ul>
            <!-- End: Breadcrumbs -->



            <!-- content starts -->
            <div class="ux-content">
                <spring:form name="addnewvulnerability" id="addnewvulnerability" method="post" commandName="vulnerabilityDTO">
                     <input type="hidden" value="${engagementDTO.encEngagementCode}" name="clientEngagementDTO.encEngagementCode" id="encEngagementCode"/>
                     <input type="hidden" value="${engagementDTO.encEngagementCode}" name="cgenk"/>
                     <input type="hidden" value="${engagementDTO.orgSchema}" name="orgSchema" id="orgSchma"/>
                     <input type="hidden" value="${vulnerabilityDTO.encInstanceIdentifier}" name="encInstanceIdentifier"/>
                     <input type="hidden" value="${pgcnt}" name="pgcnt" id="pgcnt"/>
                <div id="showaddvul1">
                    <input type="hidden" value="${pageName}" name="pageName" />
                    <c:if test="${pageName ne 'REVIEWPAGE'}">
                        <!-- Add Vulnerability -->
                        <jsp:include page="addnewvulnerability.jsp"/>
                        <!-- Add Vulnerability -->

                            <!-- CVE information -->
                            <jsp:include page="cveInformation.jsp"/>
                            <!-- CVE information -->
                            <div class="ux-float-right ux-padding-1t">
                                <c:choose>
                                    <c:when test="${pageName eq 'ADDPAGE'}">
                                        <input name="" type="button" value="Save" title="Save" class=" update ux-btn-default-action " id="addVulnerability"/>
                                    </c:when>
                                    <c:otherwise>
                                        <input name="" type="button" value="Update" title="Update" class=" update ux-btn-default-action " id="updateVulnerability"/>
                                    </c:otherwise>
                                </c:choose>
                               <c:choose>
                                    <c:when test="${!empty roadmapObj.csaDomainCode}">
                                        <input type="button" value="Cancel" title="Cancel" class="ux-btn ux-btn-default-action" onclick="cancelButtonRoadmap()"/>
                                    </c:when>
                                    <c:otherwise>
                                        <input name="" type="button" value="Cancel" title="Cancel" class="ux-btn ux-btn-default-action" id="cancelButtonNavigation"/>
                                    </c:otherwise>
                                </c:choose>
                            </div>
                        </c:if>
                        <c:if test="${viewPageName eq 'VIEWPAGE'}">
                            <jsp:include page="../analyst/viewvulnerabilitydetails.jsp"/>
                        </c:if>
                    </div>

                    <div class="ux-clear"></div>
                    <a name="success" id="success"></a>
                    <div class="ux-msg-success msg" style="display:none;">Finding Information has been added successfully</div>
                </spring:form>
            </div>
            <spring:form name="cancelReviewVulnerabilityForm" id="cancelReviewVulnerabilityForm" method="post" commandName="vulnerabilityDTO">
                <input type="hidden" value="${engagementDTO.encEngagementCode}" name="cgenk"/>
                <input type="hidden" value="${engagementDTO.orgSchema}" name="orgSchma"/>
                <input type="hidden" value="${pgcnt}" name="pgcnt" id="pgcnt"/>
                <input type="hidden" value="CANCEL" name="pageName" id="pgname"/>
            </spring:form>
                
                <form name="editRoadmap" commandName="vulnerabilityDTOs" method="POST">
                    <input type="hidden" value="${engagementDTO.encEngagementCode}" name="cgenk"/>
                    <input type="hidden" value="${engagementDTO.orgSchema}" name="orgSchma"/>
                    <input type="hidden" value="1" name="pgcnt" id="pgcnt"/>
                    <input type="hidden" value="${pageNo}" name="pgno"/>
                    <input type="hidden" value="${roadmapObj.csaDomainCode}" name="csacode" id="csacode"/>
                    <input type="hidden" value="${roadmapObj.rootCauseCode}" name="catcode" id="catcode"/>
                </form>
            <!-- content ends --> 
            <!--            <p id="back-top">
                            <a href="#top"><span></span>Back to Top</a>
                        </p>-->
            <!-- Footer : Include -->
            <jsp:include page="../includes/footer.jsp"/>
            <!-- Footer : Include --> 
        </div>
        <!-- End: Wrapper --> 
    </body>
</html>
<script src="<c:url value="/js/jquery.multiple.select.js"/>"></script> 
<script>

    $(".ms").multipleSelect({
        filter: false,
        multiple: true,
        multipleWidth: 160,
        placeholder: "Select"
    });
    $("#ms1").multipleSelect({
        filter: false,
        multiple: true,
        multipleWidth: 160,
        placeholder: "Select"
    });
    $("#ms2").multipleSelect({
        filter: false,
        multiple: true,
        multipleWidth: 160,
        placeholder: "Select"
    });
</script> 
