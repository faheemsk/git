CREATE TABLE [dbo].[CLNT_VULN_INSTC] (
    [CLNT_VULN_INSTC_KEY]    INT             IDENTITY (1, 1) NOT NULL,
    [ROW_STS_KEY]            INT             NOT NULL,
    [ORG_KEY]                INT             NOT NULL,
    [CLNT_ENGMT_CD]          VARCHAR (30)    NOT NULL,
    [SECUR_SRVC_CD]          VARCHAR (10)    NOT NULL,
    [VULN_SRC_KEY]           INT             NOT NULL,
    [VULN_INSTC_STS_CD]      VARCHAR (3)     NOT NULL,
    [VULN_SEV_CD]            VARCHAR (3)     NULL,
    [VULN_IMP_CD]            VARCHAR (3)     NULL,
    [RISK_PRBL_CD]           VARCHAR (3)     NULL,
    [RMDTN_CST_EFFRT_CD]     VARCHAR (3)     NULL,
    [VULN_CATGY_CD]          VARCHAR (10)    NULL,
    [OWASP_TOP_10_KEY]       INT             NULL,
    [CVE_ID]                 VARCHAR (25)    NULL,
    [OS_KEY]                 INT             NULL,
    [SRC_VULN_SCAN_ID]       VARCHAR (150)   NULL,
    [SRC_VULN_SCAN_STRT_DT]  DATETIME        NULL,
    [SRC_VULN_SCAN_END_DT]   DATETIME        NULL,
    [SRC_VULN_INSTC_ID]      VARCHAR (150)   NULL,
    [SRC_VULN_ID]            VARCHAR (150)   NULL,
    [VULN_NM]                VARCHAR (255)   NOT NULL,
    [VULN_DESC]              TEXT            NULL,
    [VULN_CREAT_DT]          DATETIME        NOT NULL,
    [IPADR]                  VARCHAR (39)    NULL,
    [PORT_NBR]               INT             NULL,
    [SRC_ADVS_TXT]           VARCHAR (1024)  NULL,
    [SRC_VULN_BAS_SCOR]      DECIMAL (10, 2) NULL,
    [VULN_BAS_SCOR]          DECIMAL (10, 2) NULL,
    [VULN_IMP_SUB_SCOR]      DECIMAL (10, 2) NULL,
    [VULN_EXPLT_SUB_SCOR]    DECIMAL (10, 2) NULL,
    [VULN_TMPRL_SCOR]        DECIMAL (10, 2) NULL,
    [VULN_ENV_SCOR]          DECIMAL (10, 2) NULL,
    [VULN_OVALL_SCOR]        DECIMAL (10, 2) NULL,
    [VULN_VCTR_TXT]          VARCHAR (100)   NULL,
    [NTWK_NM]                VARCHAR (150)   NULL,
    [PRTCL_NM]               VARCHAR (255)   NULL,
    [HST_NM]                 VARCHAR (150)   NULL,
    [DOM_NM]                 VARCHAR (150)   NULL,
    [SFTW_NM]                VARCHAR (150)   NULL,
    [APPL_URL]               NVARCHAR (2000) NULL,
    [NETBIOS_NM]             VARCHAR (150)   NULL,
    [MAC_ADR_NM]             VARCHAR (150)   NULL,
    [VULN_TECH_COMMT_TXT]    TEXT            NULL,
    [VULN_IMP_COMMT_TXT]     TEXT            NULL,
    [RECOM_COMMT_TXT]        TEXT            NULL,
    [ROOT_CAUS_COMMT_TXT]    TEXT            NULL,
    [APPL_FL_UPLOAD_LOG_KEY] INT             NULL,
    [CREAT_DT]               DATETIME        NOT NULL,
    [CREAT_USER_ID]          INT             NOT NULL,
    [UPDT_DT]                DATETIME        NULL,
    [UPDT_USER_ID]           INT             NULL,
    CONSTRAINT [PK_CLNT_VULN_INSTC] PRIMARY KEY CLUSTERED ([CLNT_VULN_INSTC_KEY] ASC),
    CONSTRAINT [FK_APPL_FL_UPLOAD_LOG_95] FOREIGN KEY ([APPL_FL_UPLOAD_LOG_KEY]) REFERENCES [dbo].[APPL_FL_UPLOAD_LOG] ([APPL_FL_UPLOAD_LOG_KEY]),
    CONSTRAINT [FK_CLNT_SECUR_SRVC_ENGMT_106] FOREIGN KEY ([CLNT_ENGMT_CD], [SECUR_SRVC_CD]) REFERENCES [dbo].[CLNT_SECUR_SRVC_ENGMT] ([CLNT_ENGMT_CD], [SECUR_SRVC_CD]),
    CONSTRAINT [FK_CVE_113] FOREIGN KEY ([CVE_ID]) REFERENCES [dbo].[CVE] ([CVE_ID]),
    CONSTRAINT [FK_MSTR_LKP_102] FOREIGN KEY ([ROW_STS_KEY]) REFERENCES [dbo].[MSTR_LKP] ([MSTR_LKP_KEY]),
    CONSTRAINT [FK_MSTR_LKP_103] FOREIGN KEY ([VULN_SRC_KEY]) REFERENCES [dbo].[MSTR_LKP] ([MSTR_LKP_KEY]),
    CONSTRAINT [FK_ORG_104] FOREIGN KEY ([ORG_KEY]) REFERENCES [dbo].[ORG] ([ORG_KEY]),
    CONSTRAINT [FK_OS_112] FOREIGN KEY ([OS_KEY]) REFERENCES [dbo].[OS] ([OS_KEY]),
    CONSTRAINT [FK_OWASP_TOP_10_100] FOREIGN KEY ([OWASP_TOP_10_KEY]) REFERENCES [dbo].[OWASP_TOP_10] ([OWASP_TOP_10_KEY]),
    CONSTRAINT [FK_RISK_PRBL_109] FOREIGN KEY ([RISK_PRBL_CD]) REFERENCES [dbo].[RISK_PRBL] ([RISK_PRBL_CD]),
    CONSTRAINT [FK_RMDTN_CST_EFFRT_110] FOREIGN KEY ([RMDTN_CST_EFFRT_CD]) REFERENCES [dbo].[RMDTN_CST_EFFRT] ([RMDTN_CST_EFFRT_CD]),
    CONSTRAINT [FK_VULN_CATGY_111] FOREIGN KEY ([VULN_CATGY_CD]) REFERENCES [dbo].[VULN_CATGY] ([VULN_CATGY_CD]),
    CONSTRAINT [FK_VULN_IMP_108] FOREIGN KEY ([VULN_IMP_CD]) REFERENCES [dbo].[VULN_IMP] ([VULN_IMP_CD]),
    CONSTRAINT [FK_VULN_INSTC_STS_107] FOREIGN KEY ([VULN_INSTC_STS_CD]) REFERENCES [dbo].[VULN_INSTC_STS] ([VULN_INSTC_STS_CD]),
    CONSTRAINT [FK_VULN_SEV_101] FOREIGN KEY ([VULN_SEV_CD]) REFERENCES [dbo].[VULN_SEV] ([VULN_SEV_CD])
);
GO

CREATE NONCLUSTERED INDEX [IF27_CLNT_VULN_INSTC]
    ON [dbo].[CLNT_VULN_INSTC]([VULN_NM] ASC);
GO
